
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Fitness Sphere — Weight Gain</title>

  <!-- Use the consolidated site stylesheet you provided -->
  <link rel="stylesheet" href="css/styles.css"/>

  <style>
    /* Small page-specific tweaks */
    :root { --theme-color: #ff9800; }
    main.container { padding-top: 26px; padding-bottom: 40px; }
    .muted { color: var(--muted); }
    .pair img { width: 60px; height: 60px; object-fit: contain; border-radius:8px; }
    .tracker-card { border:2px solid var(--accent); background: linear-gradient(180deg,#141827,#111425); }
    .mode-toggle button.active { box-shadow: 0 6px 18px rgba(255,152,0,0.12); }
    .calc-card { background: linear-gradient(180deg,#0f1724,#0b0f1b); }
  </style>
</head>
<body>
  <nav class="nav">
    <div class="container nav-inner">
      <a class="brand" href="index.html">
        <!-- try assets/logo.png then fallback to logo.png -->
        <img src="assets/logo.png" alt="logo" width="120"
             onerror="this.onerror=null; this.src='logo.png'">
      </a>

      <div class="links" data-menu>
        <a class="link" href="calories.html">Calories</a>
        <a class="link" href="weight-loss.html">Weight Loss</a>
        <a class="link active" href="weight-gain.html">Weight Gain</a>
        <a class="link" href="exercises.html">Exercises</a>
        <a class="link" href="premium.html">Premium</a>
      </div>
      <button class="btn secondary" data-menu-btn>Menu</button>
    </div>
  </nav>

  <main class="container section">
    <h1 class="fade-in">Weight Gain Guide & Tracker</h1>

    <section class="fade-in">
      <p class="muted">Welcome to the Weight Gain section. Use the plans and calculator below to gain healthy weight with minimal fat.</p>
    </section>

    <section class="fade-in">
      <div class="mode-toggle" role="tablist" aria-label="Bulk modes">
        <button id="cleanBulkBtn" class="active" aria-pressed="true">Clean Bulk</button>
        <button id="fastBulkBtn" aria-pressed="false">Fast Bulk</button>
      </div>

      <p id="bulkDescShort" class="muted small">
        <strong>Clean Bulk:</strong> Balanced approach to gaining muscle with minimal fat.
        <span id="readMoreToggle" class="read-more">Read more</span>
      </p>

      <div id="bulkDescFull" class="muted" style="display:none">
        <p><strong>Clean Bulk:</strong> Focus on nutrient-dense foods, lean protein, and steady calorie increases to build muscle while keeping fat gain low.</p>
        <p><strong>Fast Bulk:</strong> Rapid weight gain by consuming larger calorie surpluses; often less strict with food quality.</p>
        <p id="fastBulkCaution" class="notice warn" style="display:none"><strong>Caution:</strong> Fast bulking may cause excess fat gain — monitor and adjust.</p>
      </div>
    </section>

    <!-- Tracker: renders a full-week list with persistent completions -->
    <section id="trackerContainer" class="fade-in" aria-live="polite"></section>

    <section class="fade-in">
      <h2>Calorie Surplus Calculator</h2>
      <p class="muted">Estimate calories above maintenance required to reach your weekly gain target.</p>

      <div class="calc-card">
        <input id="wg_weight" type="number" placeholder="Weight (kg)" />
        <input id="wg_height" type="number" placeholder="Height (cm)" />
        <input id="wg_age" type="number" placeholder="Age (years)" />
        <select id="wg_gender">
          <option value="male">Male</option>
          <option value="female">Female</option>
        </select>
        <select id="wg_activity">
          <option value="1.2">Sedentary</option>
          <option value="1.375">Lightly active</option>
          <option value="1.55">Moderately active</option>
          <option value="1.725">Very active</option>
          <option value="1.9">Extra active</option>
        </select>
        <select id="wg_goal">
          <option value="0.25">+0.25 kg/week (slow)</option>
          <option value="0.5">+0.5 kg/week (moderate)</option>
          <option value="1">+1 kg/week (fast)</option>
        </select>
        <div style="display:flex;gap:10px;">
          <button class="btn" id="wg_calcBtn">Calculate</button>
          <button class="btn secondary" id="wg_resetBtn">Reset Values</button>
        </div>
      </div>
    </section>

    <section class="fade-in">
      <h3>Extra Tips</h3>
      <ul class="muted">
        <li>Choose energy-dense whole foods (nuts, avocados, whole milk, rice).</li>
        <li>Eat extra snacks and smoothies if you struggle to meet targets.</li>
        <li>Focus on progressive overload and get 7–9 hours sleep.</li>
      </ul>
    </section>
  </main>

  <!-- ui.js (utilities) -->
  <script src="js/ui.js"></script>

  <script>
  (function(){
    // --- safe fallbacks if ui.js didn't load ---
    if (typeof showToast !== 'function') {
      window.showToast = function(msg, type='info'){ alert(msg); };
    }
    if (typeof showModal !== 'function') {
      window.showModal = function(title, html){ 
        // basic fallback modal
        var s = '<strong>' + title + '</strong>\n\n' + (html.replace(/<[^>]+>/g,''));
        alert(s);
      };
    }
    if (typeof triggerFadeIn !== 'function') {
      window.triggerFadeIn = function(){ document.querySelectorAll('.fade-in').forEach(el => el.classList.add('visible')); };
    }

    // ---------- Plans ----------
    const cleanBulkPlan = [
      { day: "Day 1", exercise: "Full-body workout", diet: "High-protein breakfast", icon: "icons/dumbbell.png" },
      { day: "Day 2", exercise: "Rest & stretch", diet: "Oats & milk", icon: "icons/stretch.png" },
      { day: "Day 3", exercise: "Upper body strength", diet: "Chicken & rice", icon: "icons/biceps.png" },
      { day: "Day 4", exercise: "Cardio 20 min", diet: "Protein shake", icon: "icons/cardio.png" },
      { day: "Day 5", exercise: "Lower body strength", diet: "Sweet potatoes", icon: "icons/squat.png" },
      { day: "Day 6", exercise: "Yoga & mobility", diet: "Eggs & toast", icon: "icons/yoga.png" },
      { day: "Day 7", exercise: "Rest", diet: "Balanced meals", icon: "icons/plate.png" }
    ];
    const fastBulkPlan = [
      { day: "Day 1", exercise: "Push workout", diet: "Pasta with cheese", icon: "icons/push.png" },
      { day: "Day 2", exercise: "Rest", diet: "Smoothies", icon: "icons/smoothie.png" },
      { day: "Day 3", exercise: "Pull workout", diet: "Burgers & fries", icon: "icons/burger.png" },
      { day: "Day 4", exercise: "Leg day", diet: "Milkshakes", icon: "icons/milkshake.png" },
      { day: "Day 5", exercise: "Core training", diet: "Rice & curry", icon: "icons/abs.png" },
      { day: "Day 6", exercise: "Rest", diet: "Pizza", icon: "icons/pizza.png" },
      { day: "Day 7", exercise: "Active rest", diet: "Ice cream", icon: "icons/icecream.png" }
    ];

    // ---------- DOM Elements ----------
    const trackerContainer = document.getElementById('trackerContainer');
    const cleanBtn = document.getElementById('cleanBulkBtn');
    const fastBtn = document.getElementById('fastBulkBtn');
    const readMore = document.getElementById('readMoreToggle');
    const fullDesc = document.getElementById('bulkDescFull');
    const cautionBox = document.getElementById('fastBulkCaution');

    // ---------- Storage helpers ----------
    const todayKey = () => new Date().toISOString().slice(0,10);
    const doneKey = (mode, date, idx, type) => `wg_${mode}_${date}_${idx}_${type}`;

    // render the full week's tracker and wire checkboxes with per-date persistence
    function renderTracker(plan, mode) {
      trackerContainer.innerHTML = '';
      const date = todayKey();

      plan.forEach((item, idx) => {
        const card = document.createElement('div');
        card.className = 'tracker-card fade-in';
        // unique ids for checkboxes
        const exId = `wg_ex_${mode}_${date}_${idx}`;
        const dietId = `wg_diet_${mode}_${date}_${idx}`;

        card.innerHTML = `
          <h3>${item.day} — Exercise</h3>
          <div class="pair" style="gap:12px;align-items:center">
            <img src="${item.icon}" alt="${item.exercise}" onerror="this.onerror=null;this.src='icons/placeholder.png'"/>
            <div style="flex:1">
              <p style="margin:0 0 6px">${item.exercise}</p>
              <label style="color:var(--muted)"><input type="checkbox" id="${exId}"> Completed</label>
            </div>
          </div>

          <h3 style="margin-top:12px">${item.day} — Diet</h3>
          <div class="pair" style="gap:12px;align-items:center">
            <img src="${item.icon}" alt="${item.diet}" onerror="this.onerror=null;this.src='icons/placeholder.png'"/>
            <div style="flex:1">
              <p style="margin:0 0 6px">${item.diet}</p>
              <label style="color:var(--muted)"><input type="checkbox" id="${dietId}"> Completed</label>
            </div>
          </div>
        `;

        trackerContainer.appendChild(card);

        // restore saved states
        const exChk = document.getElementById(exId);
        const dietChk = document.getElementById(dietId);
        try {
          exChk.checked = localStorage.getItem(doneKey(mode, date, idx, 'ex')) === 'true';
          dietChk.checked = localStorage.getItem(doneKey(mode, date, idx, 'diet')) === 'true';
        } catch (e) { /* localStorage may be blocked */ }

        // bind change events
        exChk.addEventListener('change', () => {
          try {
            localStorage.setItem(doneKey(mode, date, idx, 'ex'), exChk.checked);
          } catch(e){}
          if (exChk.checked && dietChk.checked) {
            showToast('Nice! Both exercise and diet done today.', 'success');
          }
        });
        dietChk.addEventListener('change', () => {
          try {
            localStorage.setItem(doneKey(mode, date, idx, 'diet'), dietChk.checked);
          } catch(e){}
          if (exChk.checked && dietChk.checked) {
            showToast('Nice! Both exercise and diet done today.', 'success');
          }
        });
      });

      // reveal
      triggerFadeIn();
    }

    // set mode and re-render plan
    function setMode(mode){
      document.documentElement.style.setProperty('--theme-color', mode === 'fast' ? '#ff5722' : '#ff9800');
      cleanBtn.classList.toggle('active', mode === 'clean');
      fastBtn.classList.toggle('active', mode === 'fast');

      const plan = mode === 'fast' ? fastBulkPlan : cleanBulkPlan;
      renderTracker(plan, mode);
      try { localStorage.setItem('wg_mode', mode); } catch(e){}
      // show caution if appropriate
      if (mode === 'fast' && localStorage.getItem('wg_readmore') === 'open') {
        if (cautionBox) cautionBox.style.display = 'block';
      } else if (cautionBox) {
        cautionBox.style.display = 'none';
      }
    }

    // read more toggle
    readMore.addEventListener('click', ()=>{
      const hidden = fullDesc.style.display === 'none';
      fullDesc.style.display = hidden ? 'block' : 'none';
      readMore.textContent = hidden ? 'Read less' : 'Read more';
      try {
        if (hidden) localStorage.setItem('wg_readmore','open'); else localStorage.removeItem('wg_readmore');
      } catch(e){}
      if (hidden && localStorage.getItem('wg_mode') === 'fast') {
        if (cautionBox) cautionBox.style.display = 'block';
      } else if (cautionBox) cautionBox.style.display = 'none';
    });

    cleanBtn.addEventListener('click', ()=> setMode('clean'));
    fastBtn.addEventListener('click', ()=> setMode('fast'));

    // --- Calculator ---
    const calcBtn = document.getElementById('wg_calcBtn');
    const resetBtn = document.getElementById('wg_resetBtn');

    calcBtn.addEventListener('click', ()=>{
      const w = parseFloat(document.getElementById('wg_weight').value);
      const h = parseFloat(document.getElementById('wg_height').value);
      const a = parseInt(document.getElementById('wg_age').value, 10);
      const g = document.getElementById('wg_gender').value;
      const act = parseFloat(document.getElementById('wg_activity').value);
      const goal = parseFloat(document.getElementById('wg_goal').value);

      if (!w || !h || !a) {
        showToast('Please fill weight, height and age.', 'error');
        return;
      }

      const bmr = g === 'male'
        ? 88.362 + 13.397*w + 4.799*h - 5.677*a
        : 447.593 + 9.247*w + 3.098*h - 4.330*a;
      const tdee = Math.round(bmr * act);
      const surplus = (goal * 7700) / 7;
      const target = Math.round(tdee + surplus);

      // Save inputs
      try {
        localStorage.setItem('wg_calc', JSON.stringify({ w,h,a,g,act,goal }));
      } catch(e){}

      // show reply modal
      const html = `
        <p><strong>BMR:</strong> ${Math.round(bmr)} kcal/day</p>
        <p><strong>TDEE:</strong> ${tdee} kcal/day</p>
        <p><strong>Required calories to reach goal:</strong> ${target} kcal/day</p>
        <p class="muted small">Tip: Recalculate when your weight or activity changes.</p>
      `;
      showModal('Calorie Surplus Result', html);
    });

    resetBtn.addEventListener('click', ()=>{
      document.getElementById('wg_weight').value = '';
      document.getElementById('wg_height').value = '';
      document.getElementById('wg_age').value = '';
      document.getElementById('wg_gender').selectedIndex = 0;
      document.getElementById('wg_activity').selectedIndex = 0;
      document.getElementById('wg_goal').selectedIndex = 0;
      try { localStorage.removeItem('wg_calc'); showToast('Calculator inputs reset','info'); } catch(e){}
    });

    // restore saved calculator values & UI state
    window.addEventListener('load', ()=>{
      try {
        const calc = JSON.parse(localStorage.getItem('wg_calc') || '{}');
        if (calc.w) document.getElementById('wg_weight').value = calc.w;
        if (calc.h) document.getElementById('wg_height').value = calc.h;
        if (calc.a) document.getElementById('wg_age').value = calc.a;
        if (calc.g) document.getElementById('wg_gender').value = calc.g;
        if (calc.act) document.getElementById('wg_activity').value = calc.act;
        if (calc.goal) document.getElementById('wg_goal').value = calc.goal;
      } catch(e){}

      const savedMode = localStorage.getItem('wg_mode') || 'clean';
      setMode(savedMode);

      // keep readmore open if stored
      if (localStorage.getItem('wg_readmore') === 'open') {
        fullDesc.style.display = 'block';
        readMore.textContent = 'Read less';
        if (savedMode === 'fast' && cautionBox) cautionBox.style.display = 'block';
      }

      // initial fade-ins
      triggerFadeIn();
    });

  })();
  </script>
</body>
</html>
