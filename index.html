<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>FitnessSphere — Home</title>
  <meta name="description" content="FitnessSphere — clean fitness resources, trackers, and plans. Mint-gradient premium design." />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800&display=swap" rel="stylesheet">
  <style>
    /* ============================================================
       FitnessSphere — Index (Final polish)
       - Section spacing & distinct section backgrounds
       - No underlines on clickable elements
       - Prevent horizontal overflow
       - Smooth, centered menu
       - Working testimonials & submission (persisted locally)
       - Animated charts (canvas) with simple, reliable JS
       - More mint gradient + accent colors
       - All original features preserved; homepage lightweight
       ============================================================ */

    :root{
      --bg-900:#071018;
      --bg-800:#08121b;
      --mint-100:#e8fff8;
      --mint-200:#bff7ea;
      --mint-300:#86f4d0;
      --mint-400:#39e0b0;
      --mint-500:#10c08f;
      --teal-600:#0aa07a;
      --accent-1: linear-gradient(90deg,var(--mint-300),var(--mint-400));
      --muted:#9fbfb0;
      --text:#e7fff6;
      --glass: rgba(255,255,255,0.03);
      --radius:14px;
      --shadow-1:0 8px 24px rgba(2,6,10,0.6);
      --shadow-2:0 20px 40px rgba(2,6,10,0.75);
      --ease:cubic-bezier(.2,.9,.25,1);
      --max-width:1120px;
    }

    *{box-sizing:border-box}
    html,body{height:100%; margin:0; padding:0; font-family:'Inter',system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial; -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale; background:
      radial-gradient(900px 500px at 8% 10%, rgba(16,193,138,0.04), transparent 30%),
      linear-gradient(180deg,var(--bg-900),var(--bg-800));
      color:var(--text); scroll-behavior:smooth;
    }

    /* Prevent horizontal overflow / tilt */
    body { overflow-x:hidden; }

    /* Remove underlines and default button styles; keep accessible focus rings */
    a, button { text-decoration: none; border: none; background: none; color: inherit; font: inherit; -webkit-tap-highlight-color: transparent; }
    a:focus, button:focus { outline: 3px solid rgba(16,193,138,0.12); outline-offset: 4px; border-radius:8px; }

    .container{width:min(var(--max-width),94%); margin:0 auto}
    .center{display:flex; align-items:center; justify-content:center}
    .row{display:flex; gap:16px; align-items:center; flex-wrap:wrap}
    .col{flex:1; min-width:0}

    /* Header (strict: logo + name + burger) */
    header.site-header{
      position:sticky; top:0; z-index:1200; backdrop-filter: blur(8px) saturate(120%);
      background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      border-bottom: 1px solid rgba(255,255,255,0.03);
    }
    .site-header .container{display:flex; align-items:center; justify-content:space-between; padding:12px 6px}
    .brand{display:flex; gap:12px; align-items:center; text-decoration:none}
    .brand img{height:42px; width:auto; display:block; filter: drop-shadow(0 6px 18px rgba(0,0,0,0.6))}
    .brand .site-name{font-weight:800; color:var(--mint-300); letter-spacing:0.2px; font-size:1.02rem}

    /* Burger (three-line only) */
    .burger{width:48px; height:48px; display:flex; align-items:center; justify-content:center; border-radius:12px; background:rgba(255,255,255,0.02); border:1px solid rgba(255,255,255,0.03); transition: transform 160ms var(--ease)}
    .burger:active{transform:scale(.98)}
    .burger .lines{width:22px; height:16px; position:relative}
    .burger .lines span{position:absolute; left:0; right:0; height:2px; background:linear-gradient(90deg,var(--mint-300),var(--mint-500)); border-radius:2px; transition:transform 260ms var(--ease), opacity 240ms var(--ease)}
    .burger .lines span:nth-child(1){top:0} .burger .lines span:nth-child(2){top:7px} .burger .lines span:nth-child(3){top:14px}
    .burger.open .lines span:nth-child(1){transform:translateY(7px) rotate(45deg)}
    .burger.open .lines span:nth-child(2){opacity:0}
    .burger.open .lines span:nth-child(3){transform:translateY(-7px) rotate(-45deg)}

    /* Fullscreen menu: centered, smooth, not glitchy */
    .fullmenu{position:fixed; inset:0; z-index:1300; display:none; align-items:center; justify-content:center; padding:28px; background: linear-gradient(180deg, rgba(3,7,10,0.9), rgba(3,7,10,0.94)); transition: opacity 280ms var(--ease), transform 320ms var(--ease)}
    .fullmenu.show{display:flex; opacity:1}
    .menu-panel{width:min(740px,96%); border-radius:18px; padding:20px; background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01)); border:1px solid rgba(255,255,255,0.03); box-shadow:var(--shadow-2); transform: translateY(-8px); transition: transform 320ms var(--ease), opacity 280ms var(--ease); }
    .fullmenu.show .menu-panel{transform: translateY(0)}
    .menu-list{display:grid; gap:8px}
    .menu-list a{display:block; padding:12px 14px; border-radius:12px; color:var(--mint-300); font-weight:700}
    .menu-list a:hover{background:rgba(16,193,138,0.03)}

    /* HERO (spacious) */
    .hero{padding:84px 0 38px; position:relative}
    .hero-inner{max-width:980px; margin:0 auto; text-align:center; padding:0 12px}
    .chip{
      display:inline-block; padding:9px 14px; border-radius:999px; font-weight:800; color:#05221b;
      background: linear-gradient(90deg,var(--mint-300),var(--mint-500)); box-shadow: 0 8px 30px rgba(16,193,138,0.12);
      transform-origin:center; animation:chipFloat 3200ms infinite ease-in-out;
    }
    @keyframes chipFloat{0%{transform:translateY(0)}50%{transform:translateY(-6px)}100%{transform:translateY(0)}}

    .hero h1{
      margin:20px 0 8px; font-weight:900; font-size: clamp(2rem, 6.5vw, 3.6rem); line-height:1.02;
      background: linear-gradient(180deg,var(--mint-300),var(--mint-500));
      -webkit-background-clip:text; color:transparent; filter: drop-shadow(0 12px 28px rgba(10,85,70,0.18));
      letter-spacing:-0.8px; opacity:0; transform:translateY(10px); transition:opacity 520ms var(--ease),transform 520ms var(--ease);
    }
    .hero h1.in-view{opacity:1; transform:translateY(0)}
    .hero p.lead{margin:0 auto; max-width:720px; color:var(--muted); font-weight:500; font-size:clamp(0.95rem,1.6vw,1.05rem); opacity:0; transform:translateY(8px); transition:opacity 520ms var(--ease) 120ms, transform 520ms var(--ease) 120ms}
    .hero p.lead.in-view{opacity:1; transform:translateY(0)}

    .cta-row{display:flex; gap:12px; justify-content:center; margin-top:22px; flex-wrap:wrap}
    .btn { padding:12px 18px; border-radius:12px; font-weight:800; display:inline-flex; align-items:center; justify-content:center; gap:8px; transition: transform 200ms var(--ease), box-shadow 200ms var(--ease }
    .btn.primary { background: linear-gradient(90deg,var(--mint-400),var(--mint-500)); color:#04221b; box-shadow:0 12px 30px rgba(16,193,138,0.12) }
    .btn.ghost { background:transparent; color:var(--mint-300); border:1px solid rgba(255,255,255,0.03) }

    /* pre-section separator & alternate backgrounds */
    .section { padding:40px 0; }
    .section + .section { padding-top:28px; } /* space between sections */
    .section--alt { background: linear-gradient(180deg, rgba(16,193,138,0.02), rgba(255,255,255,0.00)); }

    /* hero previews (lightweight) */
    .hero-previews{display:flex; gap:12px; justify-content:center; margin-top:26px; flex-wrap:wrap}
    .preview{
      width:240px; background:linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.00)); padding:14px; border-radius:12px; border:1px solid rgba(255,255,255,0.03);
      box-shadow:var(--shadow-1); transition:transform 420ms var(--ease), box-shadow 420ms var(--ease), opacity 420ms var(--ease); opacity:0; transform:translateY(8px);
    }
    .preview.in-view{opacity:1; transform:translateY(0)}
    .preview:hover{transform:translateY(-10px); box-shadow: 0 30px 60px rgba(0,0,0,0.56)}
    .preview h4{margin:0 0 6px; color:var(--mint-300)}
    .preview p{margin:0; color:var(--muted); font-size:0.92rem}

    /* FEATURES GRID (spaced & clear) */
    .features-grid{display:grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap:20px; align-items:start}
    .feature-card{
      background:linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.00));
      border:1px solid rgba(255,255,255,0.03); padding:20px; border-radius:12px; transition:transform 360ms var(--ease), box-shadow 360ms var(--ease), opacity 420ms var(--ease);
      opacity:0; transform:translateY(10px);
    }
    .feature-card.in-view{opacity:1; transform:translateY(0)}
    .feature-card:hover{transform:translateY(-8px); box-shadow:0 26px 50px rgba(0,0,0,0.55)}
    .feature-card h3{margin:0 0 10px; background: linear-gradient(90deg,var(--mint-300),var(--teal-600)); -webkit-background-clip:text; color:transparent}

    /* Testimonials (fix user comments & spacing) */
    .test-section{display:grid; gap:14px}
    .testimonial-wrapper{display:flex; gap:12px; align-items:center; overflow:hidden; border-radius:12px}
    .testimonial-track{display:flex; gap:12px; transition:transform 600ms var(--ease); will-change: transform}
    .testimonial{min-width:260px; padding:14px; border-radius:12px; border:1px solid rgba(255,255,255,0.03); background:linear-gradient(180deg, rgba(255,255,255,0.01),transparent); opacity:0; transform:translateY(8px); transition:opacity 520ms var(--ease), transform 520ms var(--ease)}
    .testimonial.in-view{opacity:1; transform:translateY(0)}
    .testimonial h4{margin:0 0 8px; color:var(--mint-300)}
    .testimonial p{margin:0;color:var(--muted)}

    /* Testimonial submit form */
    .test-form{display:flex; gap:8px; align-items:center; flex-wrap:wrap}
    .test-form input{padding:10px;border-radius:8px;border:1px solid rgba(255,255,255,0.03); background:transparent; color:var(--text); min-width:0; flex:1}

    /* Charts (canvas) */
    .chart-card{display:flex; gap:12px; align-items:center; padding:14px; border-radius:12px; border:1px solid rgba(255,255,255,0.03); background:linear-gradient(180deg, rgba(255,255,255,0.01), transparent)}
    canvas{width:100%; height:160px; display:block}

    /* CONTACT: prevent overflow and spacing */
    .contact-panel{display:flex; gap:12px; align-items:center; justify-content:space-between; flex-wrap:wrap}
    .contact-panel form{display:flex; gap:8px; align-items:center; flex:1; min-width:0}
    .contact-panel input[type="email"], .contact-panel input[type="text"]{padding:10px;border-radius:10px;border:1px solid rgba(255,255,255,0.03);background:transparent;color:var(--text); min-width:0; flex:1}

    /* Footer spacing so it's not touching */
    footer{padding:36px 0; border-top:1px solid rgba(255,255,255,0.02); margin-top:18px}

    @media (max-width:820px){
      .hero{padding:56px 0 22px}
      .preview{width:100%}
      .feature-card{padding:16px}
      .testimonial{min-width:220px}
      .container{width:94%}
    }

  </style>
</head>
<body>

  <!-- HEADER -->
  <header class="site-header" role="banner" aria-label="Main header">
    <div class="container" style="display:flex; align-items:center; justify-content:space-between">
      <a class="brand" href="index.html" aria-label="FitnessSphere home">
        <img src="logo.png" alt="FitnessSphere logo" />
        <div class="site-name">FitnessSphere</div>
      </a>
      <button class="burger" id="burger" aria-controls="mainMenu" aria-expanded="false" aria-label="Open menu">
        <div class="lines" aria-hidden="true"><span></span><span></span><span></span></div>
      </button>
    </div>
  </header>

  <!-- Fullscreen menu -->
  <div id="mainMenu" class="fullmenu" aria-hidden="true" role="dialog" aria-label="Main menu">
    <div class="menu-panel container" role="document" aria-modal="true">
      <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:8px">
        <div style="display:flex;gap:12px;align-items:center">
          <img src="logo.png" alt="" style="height:34px">
          <div style="font-weight:800;color:var(--mint-300)">FitnessSphere</div>
        </div>
        <div>
          <button id="menuClose" class="btn">Close</button>
        </div>
      </div>

      <nav class="menu-list" aria-label="Main navigation">
        <a href="index.html">Home</a>
        <a href="exercises.html">Exercises</a>
        <a href="calories.html">Calories</a>
        <a href="weight-gain.html">Weight Gain</a>
        <a href="weight-loss.html">Weight Loss</a>
        <a href="premium.html">Premium</a>
        <a href="#contact">Contact</a>
        <a href="#faq">FAQ</a>
      </nav>

      <hr style="border:none;border-top:1px solid rgba(255,255,255,0.03);margin:14px 0" />

      <div style="display:flex;gap:10px;align-items:center;justify-content:space-between">
        <div style="color:var(--muted)">Quick actions</div>
        <div style="display:flex;gap:8px">
          <button class="btn" id="goTracker">Tracker</button>
          <button class="btn" id="goExercises">Exercises</button>
        </div>
      </div>
    </div>
  </div>

  <!-- HERO (large, centered) -->
  <main>
    <section class="section" aria-labelledby="homeTitle">
      <div class="container hero-inner">
        <div class="chip" id="heroChip">Train Smart. Live Well.</div>
        <h1 id="homeTitle">Simple tools. Serious results.</h1>
        <p class="lead">FitnessSphere puts the essentials first — clear trackers, smart exercises, and custom plans. Use the cards below to open dedicated pages with full features.</p>

        <div class="cta-row" style="margin-top:20px">
          <a class="btn primary" href="calories.html">Open Calorie Tracker</a>
          <a class="btn ghost" href="exercises.html">Browse Exercises</a>
        </div>

        <div class="hero-previews" style="margin-top:26px" aria-hidden="false">
          <a class="preview" href="calories.html">
            <h4>Calories</h4>
            <p>Quick log preview — full tracker on the calories page with CSV export and progress analytics.</p>
            <div style="margin-top:10px; display:flex; gap:8px; align-items:center;">
              <div style="width:44px;height:44px;border-radius:10px;background:var(--mint-300);display:flex;align-items:center;justify-content:center;color:#04221b;font-weight:800">C</div>
              <div style="color:var(--muted)">Today • 1.2k kcal</div>
            </div>
          </a>

          <a class="preview" href="exercises.html">
            <h4>Exercises</h4>
            <p>Search & filter workouts. The exercises page contains demo animations and saved workouts.</p>
            <div style="margin-top:10px; display:flex; gap:8px; align-items:center;">
              <div style="width:44px;height:44px;border-radius:10px;background:linear-gradient(90deg,var(--mint-300),var(--teal-600));display:flex;align-items:center;justify-content:center;color:#04221b;font-weight:800">E</div>
              <div style="color:var(--muted)">200+ exercises</div>
            </div>
          </a>

          <a class="preview" href="premium.html">
            <h4>Premium</h4>
            <p>Advanced analytics, cloud sync, and export features — preview here, full set on Premium page.</p>
            <div style="margin-top:10px; display:flex; gap:8px; align-items:center;">
              <div style="width:44px;height:44px;border-radius:10px;background:linear-gradient(90deg,var(--mint-300),var(--mint-500));display:flex;align-items:center;justify-content:center;color:#04221b;font-weight:800">★</div>
              <div style="color:var(--muted)">Enhanced sync</div>
            </div>
          </a>
        </div>
      </div>
    </section>

    <!-- FEATURES section (alternate background) -->
    <section class="section section--alt" aria-labelledby="featuresTitle">
      <div class="container">
        <div style="display:flex;align-items:center;justify-content:space-between;gap:12px;margin-bottom:12px">
          <div>
            <h2 id="featuresTitle" style="margin:0;color:var(--mint-300)">What FitnessSphere does</h2>
            <div style="color:var(--muted); margin-top:6px">Each card links to a dedicated page with the full toolset.</div>
          </div>
          <div style="color:var(--muted)">Tap a card to open the full tool</div>
        </div>

        <div class="features-grid" id="featuresGrid">
          <a class="feature-card" href="calories.html"><h3>Calorie Tracker</h3><p>Log meals quickly and view totals, macros, and CSV export on the full page.</p></a>
          <a class="feature-card" href="exercises.html"><h3>Exercise Library</h3><p>Filter by muscle/cat, save favorites, and build workouts in the exercises page.</p></a>
          <a class="feature-card" href="weight-loss.html"><h3>Weight Loss</h3><p>Structured deficit plans and cardio templates on the dedicated page.</p></a>
          <a class="feature-card" href="weight-gain.html"><h3>Weight Gain</h3><p>Surplus plans, vegetarian protein ideas, and progressive templates on the gain page.</p></a>
          <a class="feature-card" href="premium.html"><h3>Premium</h3><p>Cloud sync, advanced analytics, export & priority support described on Premium.</p></a>
          <a class="feature-card" href="#contact"><h3>Support & Resources</h3><p>Guides, FAQ and vegetarian meal templates in the resources section.</p></a>
        </div>
      </div>
    </section>

    <!-- Analytics preview (charts) -->
    <section class="section" aria-labelledby="analyticsTitle">
      <div class="container">
        <div style="display:flex;align-items:center;justify-content:space-between;gap:12px;margin-bottom:12px">
          <div>
            <h2 id="analyticsTitle" style="margin:0;color:var(--mint-300)">Quick analytics</h2>
            <div style="color:var(--muted); margin-top:6px">Interactive animated charts preview (click to open full analytics in Premium).</div>
          </div>
          <div style="color:var(--muted)">Demo charts below</div>
        </div>

        <div style="display:grid; grid-template-columns: 1fr 420px; gap:18px; align-items:start;">
          <div class="chart-card">
            <div style="flex:1">
              <canvas id="lineChart" width="800" height="240" aria-label="Weekly calories chart"></canvas>
            </div>
            <div style="width:220px; display:flex; flex-direction:column; gap:8px;">
              <div style="font-weight:800; color:var(--mint-300)">Weekly calories</div>
              <div style="color:var(--muted)">Animated line chart of the last 7 days.</div>
              <button class="btn primary" id="openAnalytics">Open analytics</button>
            </div>
          </div>

          <div class="chart-card" style="flex-direction:column; align-items:stretch">
            <div style="display:flex; align-items:center; justify-content:space-between;">
              <div style="font-weight:800; color:var(--mint-300)">Macros (today)</div>
              <div style="color:var(--muted)">Protein • Carbs • Fat</div>
            </div>
            <canvas id="doughChart" width="420" height="200" style="margin-top:12px" aria-label="Macro dough chart"></canvas>
            <div style="display:flex; gap:8px; margin-top:8px; color:var(--muted)">
              <div style="flex:1">Protein <strong id="pVal">0g</strong></div>
              <div style="flex:1">Carbs <strong id="cVal">0g</strong></div>
              <div style="flex:1">Fats <strong id="fVal">0g</strong></div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Testimonials + submit (fixed & working) -->
    <section class="section section--alt" aria-labelledby="testTitle">
      <div class="container">
        <div style="display:flex;align-items:center;justify-content:space-between;gap:12px;margin-bottom:12px">
          <div>
            <h2 id="testTitle" style="margin:0;color:var(--mint-300)">User voices</h2>
            <div style="color:var(--muted); margin-top:6px">Real comments — add yours below (stored locally).</div>
          </div>
          <div style="color:var(--muted)">Community feedback</div>
        </div>

        <div class="test-section">
          <div class="testimonial-wrapper" id="testimonialWrapper" aria-live="polite">
            <div class="testimonial-track" id="testimonialTrack">
              <!-- testimonials inserted dynamically -->
            </div>
          </div>

          <form id="testimonialForm" class="test-form" style="margin-top:12px">
            <input id="tName" type="text" placeholder="Your name (optional)" />
            <input id="tMsg" type="text" placeholder="Your short comment" />
            <button class="btn primary" type="submit">Add</button>
          </form>
        </div>
      </div>
    </section>

    <!-- CONTACT (fixed spacing; not touching bottom) -->
    <section id="contact" class="section" aria-labelledby="contactTitle">
      <div class="container">
        <div style="display:flex;align-items:center;justify-content:space-between;gap:12px;margin-bottom:12px">
          <div>
            <h2 id="contactTitle" style="margin:0;color:var(--mint-300)">Contact & Support</h2>
            <div style="color:var(--muted); margin-top:6px">Bugs, suggestions or collaboration? Send a quick note.</div>
          </div>
          <div style="color:var(--muted)">We reply ASAP</div>
        </div>

        <div class="contact-panel" style="gap:12px">
          <form id="contactForm" style="display:flex; gap:8px; align-items:center; flex:1; min-width:0">
            <input id="contactEmail" type="email" placeholder="Your email" required />
            <input id="contactMsg" type="text" placeholder="Message" required />
            <button class="btn primary" type="submit">Send</button>
          </form>
        </div>
      </div>
    </section>

    <!-- footer with safe spacing -->
    <footer>
      <div class="container" style="display:flex;align-items:center;justify-content:space-between;gap:12px">
        <div style="display:flex;gap:12px;align-items:center">
          <img src="logo.png" alt="" style="height:34px"/>
          <div style="color:var(--muted)">&copy; <span id="year"></span> FitnessSphere</div>
        </div>
        <div style="display:flex;gap:12px;align-items:center">
          <a href="#privacy" style="color:var(--muted)">Privacy</a>
          <a href="#terms" style="color:var(--muted)">Terms</a>
        </div>
      </div>
    </footer>
  </main>

  <!-- small modal root (kept minimal) -->
  <div id="modalRoot" style="position:fixed; inset:0; display:none; align-items:center; justify-content:center; z-index:1500; padding:18px;">
    <div id="modalInner" style="width:min(820px,96%); border-radius:12px; background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01)); padding:16px; border:1px solid rgba(255,255,255,0.03)"></div>
  </div>

  <script>
    /* ============================================================================
       JS for:
         - Smooth menu
         - Reveal-on-scroll
         - Animated charts (line + dough) using canvas
         - Testimonials: load/persist/display + auto-scroll
         - Contact and testimonial submissions (localStorage)
       No external libraries. All features preserved.
       ============================================================================ */

    (function(){
      const $ = s => document.querySelector(s);
      const $$ = s => Array.from(document.querySelectorAll(s));
      const year = new Date().getFullYear(); $('#year').textContent = year;

      // ========== Menu ==========
      const burger = $('#burger'), mainMenu = $('#mainMenu'), menuClose = $('#menuClose');
      function openMenu(){ burger.classList.add('open'); burger.setAttribute('aria-expanded','true'); mainMenu.classList.add('show'); mainMenu.style.display='flex'; document.body.style.overflow='hidden'; setTimeout(()=> mainMenu.querySelector('a,button')?.focus(), 200); }
      function closeMenu(){ burger.classList.remove('open'); burger.setAttribute('aria-expanded','false'); mainMenu.classList.remove('show'); mainMenu.style.opacity = '0'; document.body.style.overflow=''; setTimeout(()=> { mainMenu.style.display='none'; mainMenu.style.opacity=''; }, 320); burger.focus(); }
      burger.addEventListener('click', ()=> burger.classList.contains('open') ? closeMenu() : openMenu());
      menuClose?.addEventListener('click', closeMenu);
      mainMenu.addEventListener('click', e=> { if(e.target===mainMenu) closeMenu(); });
      document.addEventListener('keydown', e => { if(e.key==='Escape'){ closeMenu(); closeModal(); } });

      // ========== Modal helpers ==========
      const modalRoot = $('#modalRoot'), modalInner = $('#modalInner');
      function openModal(html){ modalInner.innerHTML = html; modalRoot.style.display='flex'; setTimeout(()=> modalRoot.style.opacity = '1', 10); document.body.style.overflow='hidden'; }
      function closeModal(){ modalRoot.style.opacity='0'; setTimeout(()=> { modalRoot.style.display='none'; modalInner.innerHTML=''; document.body.style.overflow=''; }, 220); }
      modalRoot.addEventListener('click', e => { if(e.target === modalRoot) closeModal(); });

      // ========== Reveal on scroll ==========
      const revealTargets = Array.from(document.querySelectorAll('.hero h1, .hero p.lead, .preview, .feature-card, .testimonial'));
      const io = new IntersectionObserver((entries) => {
        entries.forEach(en => { if(en.isIntersecting) { en.target.classList.add('in-view'); }});
      }, {threshold: 0.12});
      revealTargets.forEach(el => io.observe(el));

      // ========== Testimonials (persisted & auto-scroll) ==========
      const TEST_KEY = 'fitness_sphere_testimonials_v1';
      let testimonials = [
        {name:'Student, India', text:'Clean & quick — exactly what I needed'},
        {name:'Runner', text:'Progress rings kept me consistent'},
        {name:'Coach', text:'Premium analytics are worth it'},
        {name:'Remote worker', text:'Responsive & smooth UI'}
      ];
      // load saved testimonials (append)
      try {
        const saved = JSON.parse(localStorage.getItem(TEST_KEY) || '[]');
        if(Array.isArray(saved) && saved.length) testimonials = saved.concat(testimonials);
      } catch(e) { console.warn('test load err', e); }

      const track = $('#testimonialTrack');
      function renderTestimonials(){
        track.innerHTML = '';
        testimonials.forEach(t => {
          const div = document.createElement('div');
          div.className = 'testimonial';
          div.innerHTML = `<h4>${escapeHtml(t.text)}</h4><p style="margin-top:8px;color:var(--muted)">— ${escapeHtml(t.name)}</p>`;
          track.appendChild(div);
        });
        // ensure they animate in
        setTimeout(()=> {
          $$('.testimonial').forEach((el,i)=> setTimeout(()=> el.classList.add('in-view'), i*90));
        }, 100);
        recalcTestimonialLayout();
      }
      function escapeHtml(s){ return String(s).replace(/[&<>'"]/g, c => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":"&#39;"}[c])); }

      // Testimonial submission
      $('#testimonialForm').addEventListener('submit', function(e){
        e.preventDefault();
        const n = $('#tName').value.trim() || 'Anonymous';
        const m = $('#tMsg').value.trim();
        if(!m) { flash($('#tMsg')); return; }
        testimonials.unshift({name:n, text:m});
        // cap saved list to 50
        localStorage.setItem(TEST_KEY, JSON.stringify(testimonials.slice(0,50)));
        $('#tName').value=''; $('#tMsg').value='';
        renderTestimonials();
      });

      // Autoscroll logic
      let tIndex = 0, tTimer = null;
      function recalcTestimonialLayout(){
        // reset transform
        track.style.transform = 'translateX(0px)';
        tIndex = 0;
        if(tTimer) clearInterval(tTimer);
        if(track.children.length <= 1) return;
        tTimer = setInterval(()=> {
          tIndex = (tIndex + 1) % track.children.length;
          let offset = 0, gap = 12;
          for(let i=0;i<tIndex;i++){
            offset += Math.round(track.children[i].getBoundingClientRect().width) + gap;
          }
          track.style.transform = `translateX(-${offset}px)`;
        }, 4200);
      }
      renderTestimonials();
      window.addEventListener('resize', ()=> { recalcTestimonialLayout(); });

      // ========== Contact form (simple demo) ==========
      $('#contactForm').addEventListener('submit', function(e){
        e.preventDefault();
        const email = $('#contactEmail').value.trim();
        const msg = $('#contactMsg').value.trim();
        if(!email || !msg){ flash($('#contactMsg')); alert('Please enter email & message'); return; }
        openModal(`<div style="padding:10px"><h3 style="margin:0;color:var(--mint-300)">Thanks!</h3><p style="color:var(--muted);margin-top:8px">We got your message and will reply to ${escapeHtml(email)} (demo).</p><div style="margin-top:12px;text-align:right"><button id="closeM" class="btn primary">Close</button></div></div>`);
        $('#closeM').addEventListener('click', closeModal);
        $('#contactForm').reset();
      });

      function flash(el){ el.animate([{transform:'scale(1)'},{transform:'scale(1.02)'},{transform:'scale(1)'}],{duration:300,easing:'ease-in-out'}); }

      // ========== Simple animated charts (canvas) ==========
      // Line Chart - Weekly calories
      const lineCanvas = document.getElementById('lineChart');
      const lineCtx = lineCanvas.getContext('2d');
      // sample week data
      const weekData = [2100, 1850, 2300, 1900, 2050, 2400, 2200];
      function drawLineChart(progress){
        // progress: 0..1 animation progress
        const w = lineCanvas.width, h = lineCanvas.height;
        lineCtx.clearRect(0,0,w,h);
        // background grid
        lineCtx.fillStyle = 'rgba(255,255,255,0.01)'; lineCtx.fillRect(0,0,w,h);
        lineCtx.strokeStyle = 'rgba(255,255,255,0.04)'; lineCtx.lineWidth = 1;
        for(let i=0;i<5;i++){
          const yy = 20 + (h-40) * (i/4);
          lineCtx.beginPath(); lineCtx.moveTo(0,yy); lineCtx.lineTo(w,yy); lineCtx.stroke();
        }
        // compute geometry
        const max = Math.max(...weekData) * 1.06;
        const min = Math.min(...weekData) * 0.94;
        const range = max - min;
        const pad = 30;
        const stepX = (w - pad*2) / (weekData.length - 1);
        // draw line path
        lineCtx.beginPath();
        for(let i=0;i<weekData.length;i++){
          const x = pad + i * stepX;
          const val = weekData[i];
          // animate point interpolation from baseline to value
          const y = pad + ( (max - (min + (val - min) * progress))/ range) * (h - pad*2);
          if(i===0) lineCtx.moveTo(x,y); else lineCtx.lineTo(x,y);
        }
        // stroke gradient
        const grad = lineCtx.createLinearGradient(0,0,w,0);
        grad.addColorStop(0, 'rgba(134,244,208,0.95)'); grad.addColorStop(1, 'rgba(16,192,143,0.95)');
        lineCtx.strokeStyle = grad; lineCtx.lineWidth = 3; lineCtx.stroke();
        // fill under curve
        lineCtx.lineTo(w-pad, h-pad); lineCtx.lineTo(pad, h-pad); lineCtx.closePath();
        lineCtx.fillStyle = 'rgba(16,192,143,0.07)'; lineCtx.fill();
        // points
        for(let i=0;i<weekData.length;i++){
          const x = pad + i * stepX;
          const val = weekData[i];
          const y = pad + ( (max - (min + (val - min) * progress))/ range) * (h - pad*2);
          lineCtx.beginPath(); lineCtx.arc(x,y,4,0,Math.PI*2); lineCtx.fillStyle = '#fff'; lineCtx.fill();
          lineCtx.beginPath(); lineCtx.arc(x,y,6,0,Math.PI*2); lineCtx.strokeStyle = 'rgba(16,192,143,0.12)'; lineCtx.lineWidth=2; lineCtx.stroke();
        }
      }
      // animate line chart
      (function animateLine(){
        let start = null; function step(ts){
          if(!start) start = ts;
          const t = Math.min(1,(ts-start)/900);
          drawLineChart(t);
          if(t < 1) requestAnimationFrame(step);
        }
        requestAnimationFrame(step);
      })();

      // Dough chart (macros)
      const dCanvas = document.getElementById('doughChart');
      const dCtx = dCanvas.getContext('2d');
      // sample macros (grams) — these can be wired to real data later
      const macros = {p:120, c:240, f:70}; // grams
      $('#pVal').textContent = macros.p + 'g'; $('#cVal').textContent = macros.c + 'g'; $('#fVal').textContent = macros.f + 'g';

      function drawDough(progress){
        const w = dCanvas.width, h = dCanvas.height;
        dCtx.clearRect(0,0,w,h);
        const total = macros.p + macros.c + macros.f || 1;
        const centerX = w/2, centerY = h/2, r = Math.min(w,h)/2 - 18;
        let start = -Math.PI/2;
        const vals = [macros.p, macros.c, macros.f];
        const colors = ['#86f4d0','#39e0b0','#10c08f'];
        for(let i=0;i<vals.length;i++){
          const slice = (vals[i]/total) * Math.PI*2 * progress;
          dCtx.beginPath();
          dCtx.moveTo(centerX,centerY);
          dCtx.arc(centerX,centerY, r, start, start + slice);
          dCtx.closePath();
          dCtx.fillStyle = colors[i]; dCtx.fill();
          start += slice;
        }
        // ring
        dCtx.beginPath(); dCtx.arc(centerX,centerY,r+4,0,Math.PI*2); dCtx.lineWidth=6; dCtx.strokeStyle='rgba(255,255,255,0.04)'; dCtx.stroke();
      }
      (function animateDough(){ let s=null; function step(t){ if(!s) s=t; const p=Math.min(1,(t-s)/800); drawDough(p); if(p<1) requestAnimationFrame(step); } requestAnimationFrame(step); })();

      // ========== small polish: reveal hero text after fonts load ==========
      window.addEventListener('load', ()=> {
        setTimeout(()=> {
          document.querySelector('.hero h1')?.classList.add('in-view');
          document.querySelector('.hero p.lead')?.classList.add('in-view');
          // mark previews and features to observe
          document.querySelectorAll('.preview, .feature-card').forEach(el => el.classList.add('in-view'));
        }, 120);
      });

      // ========== Open analytics (placeholder) ==========
      $('#openAnalytics')?.addEventListener('click', ()=> openModal(`<div style="padding:12px"><h3 style="margin:0;color:var(--mint-300)">Analytics (demo)</h3><p style="color:var(--muted); margin-top:8px">Full analytics available on Premium page — this is a preview.</p><div style="margin-top:12px;text-align:right"><button id="closeA" class="btn">Close</button></div></div>`), setTimeout(()=>{},0));
      document.addEventListener('click', (e) => { if(e.target && e.target.id === 'closeA') closeModal(); });

      // ensure testimonial track recalculation on load
      setTimeout(()=> {
        if(typeof recalcTestimonialLayout === 'function') recalcTestimonialLayout();
      }, 400);

      // helper used earlier (declared here after function definitions)
      function recalcTestimonialLayout(){
        // simply reset transform so auto-scroll picks correct widths in renderTestimonials
        // this function is also defined earlier in the standalone version; ensure it's available here
        const trackEl = document.getElementById('testimonialTrack');
        if(!trackEl) return;
        trackEl.style.transform = 'translateX(0px)';
        // restart auto-scroll (simpler approach)
        let idx = 0;
        if(trackEl._timer) clearInterval(trackEl._timer);
        if(trackEl.children.length <= 1) return;
        trackEl._timer = setInterval(()=> {
          idx = (idx + 1) % trackEl.children.length;
          let offset = 0, gap = 12;
          for(let i=0;i<idx;i++){
            offset += Math.round(trackEl.children[i].getBoundingClientRect().width) + gap;
          }
          trackEl.style.transform = `translateX(-${offset}px)`;
        }, 4200);
      }

    })();
  </script>
</body>
</html>
