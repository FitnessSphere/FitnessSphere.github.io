<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Fitness Sphere — Exercises</title>
  <meta name="color-scheme" content="dark light">
  <style>
    /* ---------- Global & theme (mint) ---------- */
    :root{
      --mint-start:#7ee8c5;
      --mint-end:#64d6b0;
      --accent:#10b981;
      --bg:#071023;
      --card:#0f1724;
      --text:#e6f1ff;
      --muted:#a7c7bf;
      --glass:rgba(255,255,255,0.03);
      --shadow: 0 10px 30px rgba(0,0,0,0.45);
      --max-width:1150px;
    }
    *{box-sizing:border-box;}
    html,body{margin:0;height:100%;background:linear-gradient(180deg, #04101a 0%, #071023 100%);color:var(--text);font-family:Inter,system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial; -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale; overflow-x:hidden;}
    .container{max-width:var(--max-width);margin:0 auto;padding:0 16px;}

    /* Header */
    .nav{position:sticky;top:0;z-index:90;background:linear-gradient(90deg, rgba(7,12,20,0.9), rgba(6,10,18,0.9));border-bottom:1px solid rgba(255,255,255,0.03);backdrop-filter: blur(6px);}
    .nav-inner{display:flex;align-items:center;justify-content:space-between;padding:10px 16px;max-width:var(--max-width);margin:0 auto;}
    .brand{display:flex;align-items:center;gap:12px;}
    .brand img{height:54px;border-radius:8px;filter:drop-shadow(0 6px 18px rgba(0,0,0,0.45));}
    .nav-title{font-weight:800;letter-spacing:1px;font-size:18px;color:var(--text);pointer-events:none;}
    .menu-btn{background:var(--glass);border-radius:10px;padding:8px 10px;border:none;color:var(--text);cursor:pointer}
    .menu-panel{position:absolute;right:12px;top:70px;min-width:200px;background:linear-gradient(180deg, rgba(8,12,16,0.98), rgba(10,14,18,0.98));border-radius:12px;padding:8px;border:1px solid rgba(255,255,255,0.03);box-shadow:var(--shadow);display:flex;flex-direction:column;gap:6px}
    .menu-link{color:var(--text);text-decoration:none;padding:10px;border-radius:8px;font-weight:700}
    .menu-link:hover{background:rgba(255,255,255,0.02)}

    /* Layout */
    .page-head{padding:20px 0 8px;}
    .hero{padding:18px;border-radius:12px;background:linear-gradient(180deg, rgba(12,18,22,0.5), rgba(10,14,18,0.2));border:1px solid rgba(255,255,255,0.02)}
    h1{margin:0;font-size:26px}
    .lead{color:var(--muted);margin-top:6px;font-size:14px}

    .main-grid{display:grid;grid-template-columns: 1fr 340px; gap:18px;margin-top:14px;align-items:start;}
    .full-width{grid-column:1/-1}

    /* Cards */
    .card{background:linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.015));border:1px solid rgba(255,255,255,0.02);padding:12px;border-radius:10px;box-shadow:var(--shadow)}
    .card h3{margin:0 0 8px 0}
    .hint{color:var(--muted);font-size:13px}

    /* Search & filters */
    .search-row{display:flex;gap:8px;align-items:center}
    .search-input{flex:1;padding:10px;border-radius:10px;border:1px solid rgba(255,255,255,0.04);background:transparent;color:var(--text)}
    .select{padding:10px;border-radius:8px;background:transparent;border:1px solid rgba(255,255,255,0.04);color:var(--text)}

    /* Exercise list */
    .ex-list{display:grid;gap:10px;grid-template-columns:repeat(auto-fit,minmax(260px,1fr))}
    .ex-card{display:flex;gap:12px;align-items:flex-start;padding:10px;border-radius:10px;border:1px solid rgba(255,255,255,0.02);background:linear-gradient(180deg, rgba(255,255,255,0.01), transparent);transition:transform .12s ease}
    .ex-card:hover{transform:translateY(-6px)}
    .ex-thumb{width:96px;height:72px;border-radius:8px;background:linear-gradient(90deg,var(--mint-start),var(--mint-end));display:flex;align-items:center;justify-content:center;font-size:28px;color:#052222}
    .ex-meta{flex:1}
    .ex-title{font-weight:800;margin:0}
    .pill{display:inline-block;background:rgba(255,255,255,0.02);padding:6px 8px;border-radius:999px;font-weight:700;font-size:12px;margin-right:6px;color:var(--muted)}
    .tag{font-size:12px;padding:4px 6px;border-radius:6px;background:rgba(255,255,255,0.02);margin-right:6px;color:var(--muted)}

    .btn{display:inline-flex;align-items:center;gap:8px;padding:8px 12px;border-radius:10px;border:none;background:linear-gradient(90deg,var(--mint-start),var(--mint-end));color:#07201a;font-weight:800;cursor:pointer}
    .btn.secondary{background:transparent;border:1px solid rgba(255,255,255,0.04);color:var(--text)}
    .btn.ghost{background:transparent;color:var(--muted);border:none}

    /* Detail modal */
    .modal-bg{position:fixed;left:0;top:0;right:0;bottom:0;background:rgba(0,0,0,0.6);display:none;align-items:center;justify-content:center;z-index:999}
    .modal{width:860px;max-width:95%;background:linear-gradient(180deg, rgba(8,12,16,0.98), rgba(10,14,18,0.98));padding:18px;border-radius:12px;border:1px solid rgba(255,255,255,0.04);box-shadow:var(--shadow)}
    .modal .close{float:right;background:transparent;border:0;color:var(--muted);font-weight:800}

    /* Routine builder */
    .routine-list{display:flex;flex-direction:column;gap:8px}
    .routine-item{display:flex;align-items:center;justify-content:space-between;padding:8px;border-radius:8px;background:rgba(255,255,255,0.01);border:1px solid rgba(255,255,255,0.02)}
    .small{font-size:13px;color:var(--muted)}

    /* Timers */
    .timers{display:flex;flex-direction:column;gap:8px}
    .timer-box{display:flex;align-items:center;gap:8px;justify-content:space-between;padding:8px;border-radius:8px;background:rgba(255,255,255,0.01)}

    /* Logs */
    .logs{display:flex;flex-direction:column;gap:8px}
    .log-item{display:flex;justify-content:space-between;padding:8px;background:rgba(255,255,255,0.01);border-radius:8px}

    /* responsive */
    @media (max-width:980px){
      .main-grid{grid-template-columns:1fr; }
    }
  </style>
</head>
<body>
  <nav class="nav">
    <div class="nav-inner container">
      <div class="brand">
        <img src="logo.png" alt="Fitness Sphere"/>
        <div>
          <div class="nav-title">FITNESSSPHERE</div>
        </div>
      </div>
      <div style="display:flex;align-items:center;gap:8px;position:relative">
        <button id="menuBtn" class="menu-btn" aria-expanded="false">☰</button>
        <div id="menuPanel" class="menu-panel" hidden>
          <a class="menu-link" href="index.html">Home</a>
          <a class="menu-link" href="weight-gain.html">Weight Gain</a>
          <a class="menu-link" href="weight-loss.html">Weight Loss</a>
          <a class="menu-link" href="calories.html">Calories</a>
          <a class="menu-link" href="exercises.html">Exercises</a>
          <a class="menu-link" href="premium.html">Premium</a>
        </div>
      </div>
    </div>
  </nav>

  <main class="container page-head">
    <div class="hero card">
      <h1>Exercises — Library & Builder</h1>
      <p class="lead">Huge exercise library, workout builder, timers, logs and printable routines. Filter by muscle, equipment, difficulty, or just explore.</p>
    </div>

    <div class="main-grid">
      <!-- LEFT: library & builder -->
      <div>
        <!-- Search & filters -->
        <div class="card" style="margin-top:12px;">
          <div style="display:flex;gap:8px;align-items:center;">
            <input id="searchInput" class="search-input" placeholder="Search exercises, e.g. squat, press, plank..." />
            <select id="filterMuscle" class="select">
              <option value="">All muscles</option>
              <option value="legs">Legs</option>
              <option value="glutes">Glutes</option>
              <option value="quads">Quads</option>
              <option value="hamstrings">Hamstrings</option>
              <option value="calves">Calves</option>
              <option value="chest">Chest</option>
              <option value="back">Back</option>
              <option value="shoulders">Shoulders</option>
              <option value="arms">Arms</option>
              <option value="biceps">Biceps</option>
              <option value="triceps">Triceps</option>
              <option value="core">Core</option>
              <option value="fullbody">Full body</option>
            </select>
            <select id="filterEquip" class="select">
              <option value="">All equipment</option>
              <option value="bodyweight">Bodyweight</option>
              <option value="dumbbell">Dumbbell</option>
              <option value="barbell">Barbell</option>
              <option value="kettlebell">Kettlebell</option>
              <option value="band">Resistance band</option>
              <option value="machine">Machine</option>
              <option value="cardio">Cardio</option>
            </select>
            <select id="filterDiff" class="select">
              <option value="">Any difficulty</option>
              <option value="beginner">Beginner</option>
              <option value="intermediate">Intermediate</option>
              <option value="advanced">Advanced</option>
            </select>
            <button id="clearFilters" class="btn secondary">Clear</button>
          </div>
        </div>

        <!-- Exercise list -->
        <div class="card" style="margin-top:12px;">
          <div style="display:flex;justify-content:space-between;align-items:center;">
            <h3 style="margin:0">Exercise library</h3>
            <div class="small hint">Showing <span id="exCount">0</span> exercises</div>
          </div>
          <div id="exList" style="margin-top:10px;" class="ex-list"></div>
        </div>

        <!-- Random generator -->
        <div class="card" style="margin-top:12px;">
          <h3 style="margin:0">Random workout generator</h3>
          <div class="hint" style="margin-top:6px">Pick a focus, duration and equipment — generator will create a balanced plan.</div>
          <div style="display:flex;gap:8px;margin-top:10px;align-items:center;">
            <select id="genFocus" class="select">
              <option value="fullbody">Full body</option>
              <option value="upper">Upper body</option>
              <option value="lower">Lower body</option>
              <option value="core">Core</option>
              <option value="cardio">Cardio</option>
              <option value="strength">Strength</option>
              <option value="mobility">Mobility</option>
            </select>
            <select id="genStyle" class="select">
              <option value="circuit">Circuit (AMRAP)</option>
              <option value="emom">EMOM</option>
              <option value="tabata">Tabata</option>
              <option value="sets">Sets/reps</option>
            </select>
            <select id="genEquip" class="select">
              <option value="">Any equipment</option>
              <option value="bodyweight">Bodyweight</option>
              <option value="dumbbell">Dumbbell</option>
              <option value="barbell">Barbell</option>
              <option value="kettlebell">Kettlebell</option>
            </select>
            <input id="genTime" type="number" min="5" max="120" placeholder="mins" style="width:80px;padding:10px;border-radius:8px;border:1px solid rgba(255,255,255,0.04);background:transparent;color:var(--text)"/>
            <button id="genBtn" class="btn">Generate</button>
          </div>
          <div id="genOutput" style="margin-top:12px;"></div>
        </div>

      </div>

      <!-- RIGHT: builder, timers, logs -->
      <aside>
        <div class="card">
          <h3 style="margin:0;">Workout builder</h3>
          <div class="hint" style="margin-top:6px">Add exercises from the library to build routines. Save and print.</div>
          <div style="margin-top:10px;">
            <input id="routineName" type="text" placeholder="Routine name (e.g. 'Leg day A')" style="width:100%;padding:8px;border-radius:8px;border:1px solid rgba(255,255,255,0.04);background:transparent;color:var(--text)"/>
            <div style="margin-top:8px;" class="routine-list" id="routineList"></div>
            <div style="display:flex;gap:8px;margin-top:8px;">
              <button id="saveRoutine" class="btn">Save routine</button>
              <button id="exportRoutine" class="btn secondary">Export JSON</button>
              <button id="printRoutine" class="btn secondary">Print</button>
            </div>
            <div style="margin-top:8px;display:flex;gap:8px;">
              <select id="loadRoutineSelect" class="select" style="flex:1"></select>
              <button id="loadRoutineBtn" class="btn secondary">Load</button>
            </div>
          </div>
        </div>

        <div class="card" style="margin-top:12px;">
          <h3 style="margin:0">Timers</h3>
          <div class="timers" style="margin-top:8px;">
            <div class="timer-box">
              <div>
                <div class="small">Stopwatch</div>
                <div id="stopwatchDisplay" style="font-weight:800">00:00:00</div>
              </div>
              <div style="display:flex;gap:8px;">
                <button id="swStart" class="btn secondary">Start</button>
                <button id="swStop" class="btn secondary">Stop</button>
                <button id="swReset" class="btn secondary">Reset</button>
              </div>
            </div>

            <div class="timer-box">
              <div>
                <div class="small">Interval Timer (Tabata)</div>
                <div id="intervalDisplay" style="font-weight:800">Tabata: 20s on / 10s off</div>
              </div>
              <div style="display:flex;gap:8px;">
                <button id="itStart" class="btn">Start Tabata</button>
                <button id="itStop" class="btn secondary">Stop</button>
              </div>
            </div>
          </div>
        </div>

        <div class="card" style="margin-top:12px;">
          <h3 style="margin:0">Workout logs</h3>
          <div class="hint" style="margin-top:6px">Log your workouts, track history and progress.</div>
          <div id="logControls" style="margin-top:8px;display:flex;gap:8px;">
            <button id="logFromRoutine" class="btn">Log routine</button>
            <button id="manualLog" class="btn secondary">Manual log</button>
          </div>
          <div style="margin-top:8px;" class="logs" id="logsList"></div>
        </div>

      </aside>
    </div>

    <!-- Big modal for exercise details -->
    <div id="modalBg" class="modal-bg" aria-hidden="true">
      <div class="modal" role="dialog" aria-modal="true" id="detailModal">
        <button class="close" id="modalClose">✕</button>
        <div id="modalContent"></div>
      </div>
    </div>

  </main>

  <script>
    // Exercises page script - very feature rich
    (function(){
      // ---- Data: big exercise library (samples across categories) ----
      const EXERCISES = [
        // legs / quads / glutes
        { id:'sq_bwt', name:'Bodyweight Squat', type:'strength', equipment:'bodyweight', primary:'quads', muscles:['quads','glutes'], difficulty:'beginner', duration:60, description:'Stand shoulder-width and sit back into a squat, chest up, knees tracking toes.', steps:['Feet shoulder-width','Hips back','Knees out','Drive up'], tips:'Keep chest up and weight in heels.', mistakes:'Rounding back or knees caving in.' },
        { id:'sq_back', name:'Back Squat (Barbell)', type:'strength', equipment:'barbell', primary:'quads', muscles:['quads','glutes','hamstrings'], difficulty:'advanced', duration:90, description:'Bar across traps, descend controlled, drive up.', steps:[' unrack safely',' descend to parallel','drive through heels'], tips:'Keep a neutral spine; use spotter when heavy.' },
        { id:'lb_dead', name:'Romanian Deadlift', type:'strength', equipment:'barbell', primary:'hamstrings', muscles:['hamstrings','glutes','lower back'], difficulty:'intermediate', duration:60, description:'Hinge at hips, knees slightly bent, feel stretch in hamstrings.', steps:['Hold bar','Hinge hips back','Lower bar near knees','Stand tall'], tips:'Lead with hips; don’t round spine.' },
        { id:'lg_step', name:'Walking Lunges', type:'strength', equipment:'bodyweight', primary:'glutes', muscles:['quads','glutes'], difficulty:'beginner', duration:60, description:'Step forward and lower until both knees ~90°. Alternate legs.', steps:['Step forward','Lower hips','Push off'], tips:'Keep torso upright.' },
        { id:'hb_glute', name:'Hip Thrust', type:'strength', equipment:'barbell', primary:'glutes', muscles:['glutes','hamstrings'], difficulty:'intermediate', duration:60, description:'Back on bench, thrust hips up with weight on hips.', steps:['Set up bench','Drive hips up','Squeeze glutes'], tips:'Pause and squeeze at top.' },

        // upper / chest / push
        { id:'push_bwt', name:'Push-Up', type:'strength', equipment:'bodyweight', primary:'chest', muscles:['chest','triceps','shoulders'], difficulty:'beginner', duration:45, description:'Hands under shoulders, lower chest to ground, press up.', steps:['Hands under shoulders','Lower chest','Press up'], tips:'Keep body straight; full range.' },
        { id:'db_bp', name:'Dumbbell Bench Press', type:'strength', equipment:'dumbbell', primary:'chest', muscles:['chest','triceps','shoulders'], difficulty:'intermediate', duration:60, description:'Press dumbbells from chest until full extension.', steps:['Set on bench','Press up','Lower controlled'], tips:'Avoid flaring elbows too wide.' },
        { id:'incline_db', name:'Incline Dumbbell Press', type:'strength', equipment:'dumbbell', primary:'upper chest', muscles:['upper chest','front delts'], difficulty:'intermediate', duration:60, description:'Bench at 30–45°, press dumbbells.', steps:['Set bench incline','Press up','Lower controlled'], tips:'Keep shoulder blades squeezed.' },

        // pull / back
        { id:'row_db', name:'Dumbbell Row', type:'strength', equipment:'dumbbell', primary:'back', muscles:['lats','mid-back'], difficulty:'beginner', duration:60, description:'One-arm row with flat back, pull elbow to hip.', steps:['Hinge at hips','Row elbow to hip','Lower with control'], tips:'Avoid rotating torso.' },
        { id:'pullup', name:'Pull-Up', type:'strength', equipment:'bodyweight', primary:'back', muscles:['lats','biceps'], difficulty:'advanced', duration:45, description:'Hang from bar, pull chin above bar.', steps:['Dead hang','Pull up','Control down'], tips:'Use full range; avoid kipping (unless doing kipping pull-ups).', mistakes:'Swinging or partial reps.' },
        { id:'latpulldown', name:'Lat Pulldown (Machine)', type:'strength', equipment:'machine', primary:'back', muscles:['lats'], difficulty:'beginner', duration:60, description:'Pull bar to chest; controlled release.', steps:['Grip wide','Pull to chest','Control up'], tips:'Avoid leaning too far back.' },

        // shoulders / arms
        { id:'ohp', name:'Overhead Press (Barbell)', type:'strength', equipment:'barbell', primary:'shoulders', muscles:['delts','triceps'], difficulty:'intermediate', duration:60, description:'Press bar from chest overhead until locked out.', steps:['Grip slightly wider than shoulder','Press overhead','Lower controlled'], tips:'Brace core; avoid excessive back arch.' },
        { id:'db_sh_press', name:'Dumbbell Shoulder Press', type:'strength', equipment:'dumbbell', primary:'shoulders', muscles:['delts'], difficulty:'beginner', duration:60, description:'Seated or standing press with dumbbells.', steps:['Set dumbbells','Press overhead','Lower with control'] },
        { id:'tricep_kb', name:'Triceps Dip (Bench)', type:'strength', equipment:'bench', primary:'triceps', muscles:['triceps','chest'], difficulty:'beginner', duration:45, description:'Hands on bench behind, lower hips, press up.', steps:['Hands on bench','Lower hips','Press up'], tips:'Keep elbows close to body.' },
        { id:'bicep_curl', name:'Dumbbell Biceps Curl', type:'strength', equipment:'dumbbell', primary:'biceps', muscles:['biceps'], difficulty:'beginner', duration:45, description:'Curl with elbows fixed at sides.', steps:['Hold dumbbells','Curl up','Lower slowly'], tips:'Avoid swinging the body.' },

        // core
        { id:'plank', name:'Plank', type:'isometric', equipment:'bodyweight', primary:'core', muscles:['abs','obliques','lower back'], difficulty:'beginner', duration:60, description:'Forearms on floor, body in straight line, hold.', steps:['Forearms on ground','Keep body straight','Breathe'], tips:'Don’t let hips sag.' },
        { id:'dead_bug', name:'Dead Bug', type:'mobility', equipment:'bodyweight', primary:'core', muscles:['abs'], difficulty:'beginner', duration:60, description:'Lay on back, alternate opposite arm & leg lowers.', steps:['Lay supine','Lower limb/arm','Return controlled'] },

        // cardio & conditioning
        { id:'run', name:'Running (Outdoor)', type:'cardio', equipment:'none', primary:'cardio', muscles:['legs'], difficulty:'variable', duration:600, description:'Continuous running outdoors. Adjust pace per goal.' },
        { id:'bike', name:'Cycling (Stationary)', type:'cardio', equipment:'cardio', primary:'cardio', muscles:['legs','glutes'], difficulty:'variable', duration:600, description:'Stationary bike workouts: steady-state or intervals.' },
        { id:'row', name:'Rowing Machine', type:'cardio', equipment:'cardio', primary:'cardio', muscles:['fullbody'], difficulty:'intermediate', duration:600, description:'Full-body low-impact cardio. Use legs then back then arms.' },

        // kettlebell
        { id:'kb_swing', name:'Kettlebell Swing', type:'power', equipment:'kettlebell', primary:'posterior chain', muscles:['glutes','hamstrings','back'], difficulty:'intermediate', duration:60, description:'Hinge and snap hips to swing kettlebell to chest height.' },

        // plyometrics
        { id:'box_jump', name:'Box Jump', type:'plyo', equipment:'box', primary:'power', muscles:['quads','glutes'], difficulty:'intermediate', duration:30, description:'Jump onto box with soft knees, step down carefully.' },

        // mobility / yoga
        { id:'child_pose', name:'Child Pose', type:'mobility', equipment:'mat', primary:'mobility', muscles:['back','hips'], difficulty:'beginner', duration:60, description:'Kneel and sit back to heels, stretch arms forward.' },
        { id:'downward_dog', name:'Downward Dog', type:'yoga', equipment:'mat', primary:'mobility', muscles:['hamstrings','shoulders'], difficulty:'beginner', duration:45, description:'Hands and feet on floor, hips up, create an inverted V.' },

        // band exercises
        { id:'band_row', name:'Band Seated Row', type:'strength', equipment:'band', primary:'back', muscles:['lats','mid-back'], difficulty:'beginner', duration:60, description:'Wrap band around feet and pull hands to hips.' },

        // machines and specialty
        { id:'leg_press', name:'Leg Press', type:'strength', equipment:'machine', primary:'quads', muscles:['quads','glutes'], difficulty:'beginner', duration:60, description:'Push platform away until legs near extension then return.' },
        { id:'leg_curl', name:'Leg Curl (Machine)', type:'strength', equipment:'machine', primary:'hamstrings', muscles:['hamstrings'], difficulty:'beginner', duration:45, description:'Curl heels toward glutes with control.' },

        // rehab / low impact
        { id:'glute_bridge', name:'Glute Bridge', type:'rehab', equipment:'bodyweight', primary:'glutes', muscles:['glutes','hamstrings'], difficulty:'beginner', duration:45, description:'Lay on back, knees bent, lift hips to squeeze glutes.' },

        // Olympic & heavy lifts
        { id:'clean', name:'Power Clean', type:'olympic', equipment:'barbell', primary:'power', muscles:['fullbody'], difficulty:'advanced', duration:90, description:'Explosive lift from floor to shoulders in one motion.' },

        // more bodyweight / variations
        { id:'pistol', name:'Pistol Squat', type:'strength', equipment:'bodyweight', primary:'quads', muscles:['quads','glutes'], difficulty:'advanced', duration:60, description:'Single-leg squat to full depth.' },
        { id:'burpee', name:'Burpee', type:'conditioning', equipment:'bodyweight', primary:'fullbody', muscles:['fullbody','cardio'], difficulty:'intermediate', duration:45, description:'Drop to plank, push-up, jump up and clap overhead.' },

        // additional sample exercises to broaden the library (add many)
        { id:'calf_raise', name:'Standing Calf Raise', type:'strength', equipment:'bodyweight', primary:'calves', muscles:['calves'], difficulty:'beginner', duration:30, description:'Stand on toes and raise/lower slowly.' },
        { id:'farmer', name:'Farmer Carry', type:'strongman', equipment:'dumbbell', primary:'fullbody', muscles:['grip','core'], difficulty:'intermediate', duration:60, description:'Carry heavy weights, upright posture.' },
        { id:'sled_push', name:'Sled Push', type:'conditioning', equipment:'sled', primary:'legs', muscles:['quads','glutes'], difficulty:'advanced', duration:60, description:'Push sled for distance or time.' },

        // core variations
        { id:'hanging_knee', name:'Hanging Knee Raise', type:'core', equipment:'pullup_bar', primary:'core', muscles:['abs','hip flexors'], difficulty:'intermediate', duration:45, description:'Hang and bring knees to chest.' },

        // mobility / activation
        { id:'band_pull', name:'Band Pull-Apart', type:'mobility', equipment:'band', primary:'shoulders', muscles:['rear delts'], difficulty:'beginner', duration:30, description:'Pull band apart at shoulder height, squeeze shoulder blades.' },

        // conditioning circuits
        { id:'mountain_climber', name:'Mountain Climbers', type:'conditioning', equipment:'bodyweight', primary:'core', muscles:['core','cardio'], difficulty:'beginner', duration:30, description:'Alternate knee drives from plank position at pace.' },

        // sample stretching
        { id:'hamstring_stretch', name:'Seated Hamstring Stretch', type:'stretch', equipment:'mat', primary:'mobility', muscles:['hamstrings'], difficulty:'beginner', duration:30, description:'Seated, reach for toes keeping spine long.' },

        // add more to reach a large library
        { id:'incline_push', name:'Incline Push-Up', type:'strength', equipment:'bodyweight', primary:'chest', muscles:['chest','triceps'], difficulty:'beginner', duration:30, description:'Hands elevated on bench, press up.' },
        { id:' decline_push', name:'Decline Push-Up', type:'strength', equipment:'bodyweight', primary:'upper chest', muscles:['chest','shoulders'], difficulty:'intermediate', duration:30, description:'Feet elevated, press up.' },
        { id:'goblet', name:'Goblet Squat', type:'strength', equipment:'dumbbell', primary:'quads', muscles:['quads','glutes'], difficulty:'beginner', duration:60, description:'Hold weight at chest and squat.' },
        { id:'step_up', name:'Step Up', type:'strength', equipment:'box', primary:'quads', muscles:['quads','glutes'], difficulty:'beginner', duration:45, description:'Step onto box with drive through heel.' },
        { id:'leg_ext', name:'Leg Extension (Machine)', type:'strength', equipment:'machine', primary:'quads', muscles:['quads'], difficulty:'beginner', duration:45, description:'Extend knees with controlled motion.' },

        // shoulder & rotator cuff
        { id:'facepull', name:'Face Pull (Cable/Band)', type:'mobility', equipment:'band', primary:'rear delts', muscles:['rear delts'], difficulty:'beginner', duration:30, description:'Pull rope to face height focusing scapular retraction.' },

        // specialized
        { id:'sprint', name:'Sprint Intervals', type:'cardio', equipment:'none', primary:'cardio', muscles:['legs'], difficulty:'advanced', duration:300, description:'Short maximal sprints with rests.' },

        // finish list with many basics repeated in variants for variety
        { id:'bench_press', name:'Barbell Bench Press', type:'strength', equipment:'barbell', primary:'chest', muscles:['chest','triceps'], difficulty:'intermediate', duration:60, description:'Press bar from chest until full extension.' },
        { id:'incline_bench', name:'Incline Bench (Barbell)', type:'strength', equipment:'barbell', primary:'upper chest', muscles:['chest','front delts'], difficulty:'intermediate', duration:60, description:'Incline bench press for upper chest emphasis.' },
        { id:'seated_row', name:'Seated Cable Row', type:'strength', equipment:'machine', primary:'back', muscles:['lats','midback'], difficulty:'beginner', duration:60, description:'Pull handle to stomach keeping torso stable.' },
        { id:'lat_hang', name:'Dead Hang', type:'mobility', equipment:'bar', primary:'shoulder_health', muscles:['shoulders','grip'], difficulty:'beginner', duration:30, description:'Hang to decompress shoulders and stretch lats.' }
      ];

      // ---- State & storage keys ----
      const STORAGE_ROUTINES = 'ex_routines';
      const STORAGE_FAVS = 'ex_favorites';
      const STORAGE_LOGS = 'ex_logs';

      // ---- Helpers: DOM refs ----
      const exListEl = document.getElementById('exList');
      const exCountEl = document.getElementById('exCount');
      const searchInput = document.getElementById('searchInput');
      const filterMuscle = document.getElementById('filterMuscle');
      const filterEquip = document.getElementById('filterEquip');
      const filterDiff = document.getElementById('filterDiff');
      const clearFilters = document.getElementById('clearFilters');

      // Routine builder refs
      const routineListEl = document.getElementById('routineList');
      const routineNameInput = document.getElementById('routineName');
      const saveRoutineBtn = document.getElementById('saveRoutine');
      const loadRoutineSelect = document.getElementById('loadRoutineSelect');
      const loadRoutineBtn = document.getElementById('loadRoutineBtn');
      const exportRoutineBtn = document.getElementById('exportRoutine');
      const printRoutineBtn = document.getElementById('printRoutine');

      // Generator / timers / logs
      const genBtn = document.getElementById('genBtn'), genOutput = document.getElementById('genOutput');
      const genFocus = document.getElementById('genFocus'), genStyle = document.getElementById('genStyle'), genEquip = document.getElementById('genEquip'), genTime = document.getElementById('genTime');

      const swDisplay = document.getElementById('stopwatchDisplay'), swStart = document.getElementById('swStart'), swStop = document.getElementById('swStop'), swReset = document.getElementById('swReset');
      const itStart = document.getElementById('itStart'), itStop = document.getElementById('itStop'), intervalDisplay = document.getElementById('intervalDisplay');

      const logFromRoutineBtn = document.getElementById('logFromRoutine'), manualLogBtn = document.getElementById('manualLog'), logsList = document.getElementById('logsList');

      const modalBg = document.getElementById('modalBg'), modalContent = document.getElementById('modalContent'), modalClose = document.getElementById('modalClose');

      // menu
      const menuBtn = document.getElementById('menuBtn'), menuPanel = document.getElementById('menuPanel');
      if(menuBtn && menuPanel){
        menuBtn.addEventListener('click', ()=> {
          const expanded = menuBtn.getAttribute('aria-expanded') === 'true';
          menuBtn.setAttribute('aria-expanded', String(!expanded));
          menuPanel.hidden = expanded;
        });
        document.addEventListener('click', (e)=> {
          if(!menuPanel) return;
          if(menuPanel.hidden) return;
          if(menuBtn.contains(e.target) || menuPanel.contains(e.target)) return;
          menuPanel.hidden = true;
          menuBtn.setAttribute('aria-expanded','false');
        });
      }

      // ---- Render exercises list with filters & search ----
      function matchesFilter(ex, q, muscle, equip, diff){
        if(q){
          const lq = q.toLowerCase();
          if(!(ex.name.toLowerCase().includes(lq) || (ex.description && ex.description.toLowerCase().includes(lq)))) return false;
        }
        if(muscle && muscle !== ''){
          // match if primary or muscles includes muscle
          if(ex.primary !== muscle && !(ex.muscles || []).includes(muscle) && !ex.muscles.join(',').includes(muscle)) return false;
        }
        if(equip && equip !== ''){
          if(ex.equipment !== equip) return false;
        }
        if(diff && diff !== ''){
          if(ex.difficulty !== diff) return false;
        }
        return true;
      }

      function renderExerciseCard(ex){
        const card = document.createElement('div'); card.className='ex-card card';
        // thumbnail placeholder (svg)
        const thumb = document.createElement('div'); thumb.className='ex-thumb';
        thumb.innerHTML = `<svg width="72" height="56" viewBox="0 0 72 56" xmlns="http://www.w3.org/2000/svg"><rect width="72" height="56" rx="8" fill="url(#g)"/><defs><linearGradient id="g" x1="0" x2="1"><stop offset="0" stop-color="#7ee8c5"/><stop offset="1" stop-color="#64d6b0"/></linearGradient></defs><text x="50%" y="55%" text-anchor="middle" font-size="20" font-weight="800" fill="#052222">${ex.name.split(' ')[0].slice(0,2).toUpperCase()}</text></svg>`;
        // meta
        const meta = document.createElement('div'); meta.className='ex-meta';
        const title = document.createElement('div'); title.className='ex-title'; title.textContent = ex.name;
        const sub = document.createElement('div'); sub.className='small hint'; sub.innerHTML = `${ex.primary ? ex.primary : ''} • ${ex.equipment} • ${ex.difficulty}`

        const tags = document.createElement('div'); tags.style.marginTop='6px';
        (ex.muscles || []).slice(0,3).forEach(m => {
          const t = document.createElement('span'); t.className='tag'; t.textContent = m; tags.appendChild(t);
        });

        const actions = document.createElement('div'); actions.style.marginTop='8px'; actions.style.display='flex'; actions.style.gap='8px';
        const viewBtn = document.createElement('button'); viewBtn.className='btn secondary'; viewBtn.textContent='View'; viewBtn.addEventListener('click', ()=> showDetail(ex.id));
        const addBtn = document.createElement('button'); addBtn.className='btn'; addBtn.textContent='Add'; addBtn.addEventListener('click', ()=> addToRoutine(ex.id));
        actions.appendChild(viewBtn); actions.appendChild(addBtn);

        meta.appendChild(title); meta.appendChild(sub); meta.appendChild(tags); meta.appendChild(actions);

        card.appendChild(thumb); card.appendChild(meta);
        return card;
      }

      function renderList(){
        const q = searchInput.value.trim();
        const muscle = filterMuscle.value;
        const equip = filterEquip.value;
        const diff = filterDiff.value;
        exListEl.innerHTML = '';
        const visible = EXERCISES.filter(ex => matchesFilter(ex,q,muscle,equip,diff));
        exCountEl.textContent = visible.length;
        visible.forEach(ex => exListEl.appendChild(renderExerciseCard(ex)));
      }

      // Filters
      [searchInput, filterMuscle, filterEquip, filterDiff].forEach(el => {
        if(!el) return;
        el.addEventListener('input', renderList);
        el.addEventListener('change', renderList);
      });
      clearFilters.addEventListener('click', ()=> {
        searchInput.value=''; filterMuscle.value=''; filterEquip.value=''; filterDiff.value='';
        renderList();
      });

      // initial render
      renderList();

      // ---- Modal detail ----
      function showDetail(id){
        const ex = EXERCISES.find(e=>e.id===id);
        if(!ex) return;
        modalContent.innerHTML = '';
        const h = document.createElement('h2'); h.textContent = ex.name;
        const p = document.createElement('p'); p.className='hint'; p.textContent = ex.description || '';
        const info = document.createElement('div'); info.style.marginTop='10px';
        info.innerHTML = `<div class="small">Equipment: <strong>${ex.equipment}</strong></div>
                          <div class="small">Primary: <strong>${ex.primary || 'general'}</strong></div>
                          <div class="small">Difficulty: <strong>${ex.difficulty}</strong></div>
                          <div class="small">Approx time: <strong>${ex.duration || 60}s</strong></div>`;
        const steps = document.createElement('div'); steps.style.marginTop='12px';
        if(ex.steps && ex.steps.length){
          steps.innerHTML = '<strong>Steps</strong>';
          const ol = document.createElement('ol');
          ex.steps.forEach(s => { const li=document.createElement('li'); li.textContent=s; ol.appendChild(li); });
          steps.appendChild(ol);
        }
        const tips = document.createElement('div'); tips.style.marginTop='10px'; tips.innerHTML = ex.tips ? `<strong>Tips</strong><p class="hint">${ex.tips}</p>` : '';
        const mistakes = document.createElement('div'); mistakes.style.marginTop='8px'; mistakes.innerHTML = ex.mistakes ? `<strong>Common mistakes</strong><p class="hint">${ex.mistakes}</p>` : '';
        const actions = document.createElement('div'); actions.style.marginTop='12px';
        const addBtn = document.createElement('button'); addBtn.className='btn'; addBtn.textContent='Add to routine'; addBtn.addEventListener('click', ()=> { addToRoutine(ex.id); hideModal(); });
        const favBtn = document.createElement('button'); favBtn.className='btn secondary'; favBtn.textContent='Add favorite'; favBtn.addEventListener('click', ()=> { toggleFavorite(ex.id); favBtn.textContent='Favorited'; });
        actions.appendChild(addBtn); actions.appendChild(favBtn);

        modalContent.appendChild(h); modalContent.appendChild(p); modalContent.appendChild(info); modalContent.appendChild(steps); modalContent.appendChild(tips); modalContent.appendChild(mistakes); modalContent.appendChild(actions);
        modalBg.style.display='flex'; modalBg.setAttribute('aria-hidden','false');
      }
      function hideModal(){ modalBg.style.display='none'; modalBg.setAttribute('aria-hidden','true'); }
      modalClose.addEventListener('click', hideModal);
      modalBg.addEventListener('click', (e)=> { if(e.target === modalBg) hideModal(); });

      // ---- Favorites (simple) ----
      function getFavorites(){ try { return JSON.parse(localStorage.getItem(STORAGE_FAVS) || '[]'); } catch(e){return [];} }
      function toggleFavorite(id){ const fav = getFavorites(); if(fav.includes(id)){ const i=fav.indexOf(id); fav.splice(i,1); } else fav.push(id); localStorage.setItem(STORAGE_FAVS, JSON.stringify(fav)); }

      // ---- Routine builder ----
      let currentRoutine = []; // array of exercise ids in order
      function addToRoutine(id){
        currentRoutine.push(id);
        renderRoutine();
      }
      function renderRoutine(){
        routineListEl.innerHTML = '';
        currentRoutine.forEach((id, idx) => {
          const ex = EXERCISES.find(e=>e.id===id);
          const item = document.createElement('div'); item.className='routine-item';
          const left = document.createElement('div'); left.style.display='flex'; left.style.gap='8px'; left.style.alignItems='center';
          const title = document.createElement('div'); title.innerHTML = `<strong>${ex ? ex.name : id}</strong><div class="small">${ex ? ex.equipment + ' • ' + ex.primary : ''}</div>`;
          left.appendChild(title);
          const right = document.createElement('div'); right.style.display='flex'; right.style.gap='6px';
          const up = document.createElement('button'); up.className='btn secondary'; up.textContent='↑'; up.addEventListener('click', ()=> { if(idx>0){ [currentRoutine[idx-1], currentRoutine[idx]]= [currentRoutine[idx], currentRoutine[idx-1]]; renderRoutine(); } });
          const down = document.createElement('button'); down.className='btn secondary'; down.textContent='↓'; down.addEventListener('click', ()=> { if(idx<currentRoutine.length-1){ [currentRoutine[idx+1], currentRoutine[idx]] = [currentRoutine[idx], currentRoutine[idx+1]]; renderRoutine(); } });
          const rem = document.createElement('button'); rem.className='btn secondary'; rem.textContent='Remove'; rem.addEventListener('click', ()=> { currentRoutine.splice(idx,1); renderRoutine(); });
          right.appendChild(up); right.appendChild(down); right.appendChild(rem);
          item.appendChild(left); item.appendChild(right);
          routineListEl.appendChild(item);
        });
      }

      // Save/load routines
      function saveRoutine(){
        const name = (routineNameInput.value || 'My routine').trim();
        if(!name) return alert('Enter a routine name');
        const stored = JSON.parse(localStorage.getItem(STORAGE_ROUTINES) || '[]');
        stored.push({ name, exercises: currentRoutine.slice(), created: Date.now() });
        localStorage.setItem(STORAGE_ROUTINES, JSON.stringify(stored));
        updateRoutinesDropdown();
        alert('Saved routine: ' + name);
      }
      function updateRoutinesDropdown(){
        const arr = JSON.parse(localStorage.getItem(STORAGE_ROUTINES) || '[]');
        loadRoutineSelect.innerHTML = '';
        arr.forEach((r, i)=> {
          const o = document.createElement('option'); o.value = i; o.textContent = r.name + ' (' + new Date(r.created).toLocaleDateString() + ')'; loadRoutineSelect.appendChild(o);
        });
      }
      function loadRoutine(){
        const idx = parseInt(loadRoutineSelect.value);
        if(isNaN(idx)) return alert('Select a routine');
        const arr = JSON.parse(localStorage.getItem(STORAGE_ROUTINES) || '[]');
        if(!arr[idx]) return;
        currentRoutine = arr[idx].exercises.slice();
        routineNameInput.value = arr[idx].name;
        renderRoutine();
      }
      function exportRoutine(){
        const name = (routineNameInput.value || 'routine').replace(/\s+/g,'_');
        const data = { name: routineNameInput.value || 'Routine', exercises: currentRoutine.map(id => EXERCISES.find(e=>e.id===id) || {id})};
        const blob = new Blob([JSON.stringify(data, null, 2)], {type:'application/json'});
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a'); a.href=url; a.download = name + '.json'; document.body.appendChild(a); a.click(); a.remove();
        URL.revokeObjectURL(url);
      }
      function printRoutine(){
        const win = window.open('', '_blank', 'width=800,height=800');
        let html = `<html><head><title>${routineNameInput.value || 'Routine'}</title></head><body style="font-family:Arial;padding:20px;color:#000">`;
        html += `<h1>${routineNameInput.value || 'Routine'}</h1>`;
        html += '<ol>';
        currentRoutine.forEach(id => { const ex = EXERCISES.find(e=>e.id===id); html += `<li><strong>${ex ? ex.name : id}</strong> — ${ex ? ex.description || '' : ''}</li>`; });
        html += '</ol></body></html>';
        win.document.write(html); win.document.close(); win.print();
      }

      saveRoutineBtn.addEventListener('click', saveRoutine);
      loadRoutineBtn.addEventListener('click', loadRoutine);
      exportRoutineBtn.addEventListener('click', exportRoutine);
      printRoutineBtn.addEventListener('click', printRoutine);
      updateRoutinesDropdown();

      // ---- Generator ----
      function generateWorkout(){
        const focus = genFocus.value;
        const style = genStyle.value;
        const equip = genEquip.value;
        const time = parseInt(genTime.value) || 20; // minutes
        // filter exercises by focus (simple heuristic)
        let pool = EXERCISES.slice();
        if(equip) pool = pool.filter(e => e.equipment === equip || e.equipment === 'bodyweight');
        if(focus === 'upper') pool = pool.filter(e => (e.primary && (e.primary==='chest' || e.primary==='back' || e.primary==='shoulders' || e.muscles && e.muscles.includes('arms'))));
        if(focus === 'lower') pool = pool.filter(e => (e.primary && (e.primary==='quads' || e.primary==='glutes' || e.primary==='hamstrings' || e.primary==='calves')));
        if(focus === 'core') pool = pool.filter(e => e.primary && e.primary==='core' || (e.muscles && e.muscles.includes('core')));
        if(focus === 'cardio') pool = pool.filter(e => e.type==='cardio' || e.type==='conditioning' || e.type==='plyo');

        if(pool.length === 0) pool = EXERCISES.slice();

        // Choose structure
        if(style === 'tabata'){
          // 4–6 exercises alternating for tabata rounds
          const rounds = Math.max(1, Math.floor(time / 4)); // rough
          let picks = shuffle(pool).slice(0, Math.min(8, pool.length));
          let out = `<div class="small hint">Tabata — 20s on / 10s off — ${rounds} rounds (approx)</div><ol>`;
          picks.forEach(p => out += `<li>${p.name} — ${p.equipment} — ${p.difficulty}</li>`);
          out += '</ol>';
          genOutput.innerHTML = out;
          return;
        } else if(style === 'emom'){
          // EMOM: one movement per minute
          const minutes = Math.max(5, time);
          const picks = shuffle(pool).slice(0, minutes);
          let out = `<div class="small hint">EMOM — ${minutes} minutes</div><ol>`;
          picks.forEach((p,i)=> out += `<li>Minute ${i+1}: ${p.name} — ${p.equipment}</li>`);
          out += '</ol>';
          genOutput.innerHTML = out; return;
        } else if(style === 'circuit'){
          // circuit AMRAP style
          const picks = shuffle(pool).slice(0, Math.min(8, pool.length));
          let out = `<div class="small hint">Circuit/AMRAP — ${time} minutes</div><ol>`;
          picks.forEach(p=> out += `<li>${p.name} — 30-60s or 8-15 reps</li>`);
          out += '</ol>'; genOutput.innerHTML = out; return;
        } else {
          // sets style: pick 5 exercises for sets/reps
          const picks = shuffle(pool).slice(0,5);
          let out = `<div class="small hint">Strength set-based routine — ${time} minutes</div><ol>`;
          picks.forEach(p=> out += `<li>${p.name} — 3–4 sets x 6–12 reps (${p.equipment})</li>`);
          out += '</ol>'; genOutput.innerHTML = out; return;
        }
      }
      genBtn.addEventListener('click', generateWorkout);

      function shuffle(a){ return a.sort(()=>Math.random()-0.5); }

      // ---- Timers: stopwatch & tabata interval ----
      let swTimer = null, swStartTime = null, swElapsed = 0;
      swStart.addEventListener('click', ()=> {
        if(swTimer) return;
        swStartTime = Date.now() - swElapsed;
        swTimer = setInterval(()=> {
          swElapsed = Date.now() - swStartTime;
          swDisplay.textContent = msToTime(swElapsed);
        }, 200);
      });
      swStop.addEventListener('click', ()=> {
        clearInterval(swTimer); swTimer = null;
      });
      swReset.addEventListener('click', ()=> { clearInterval(swTimer); swTimer=null; swElapsed=0; swDisplay.textContent='00:00:00'; });

      function msToTime(ms){
        const s = Math.floor(ms/1000)%60; const m = Math.floor(ms/60000)%60; const h = Math.floor(ms/3600000);
        return [h,m,s].map(n=>String(n).padStart(2,'0')).join(':');
      }

      // Interval (Tabata)
      let itRunning=false, itTimer=null, itState='work', itRound=0, itTotalRounds=8;
      itStart.addEventListener('click', ()=> {
        if(itRunning) return;
        itRunning = true; itState='work'; itRound=0; runIntervalRound();
      });
      itStop.addEventListener('click', ()=> { stopInterval(); });

      function runIntervalRound(){
        if(!itRunning) return;
        itRound++;
        let work = 20, rest=10; // Tabata default
        intervalDisplay.textContent = `Round ${itRound}/${itTotalRounds} — ${itState}`;
        if(itState==='work'){
          playBeep(); setTimeout(()=> { itState='rest'; runIntervalRound(); }, work*1000);
        } else {
          playBeep(); setTimeout(()=> { itState='work'; if(itRound>=itTotalRounds*2) { stopInterval(); } else runIntervalRound(); }, rest*1000);
        }
      }
      function stopInterval(){ itRunning=false; clearInterval(itTimer); intervalDisplay.textContent='Tabata: stopped'; }

      function playBeep(){
        try{
          const ctx = new (window.AudioContext || window.webkitAudioContext)();
          const o = ctx.createOscillator();
          const g = ctx.createGain();
          o.connect(g); g.connect(ctx.destination);
          o.type='sine'; o.frequency.value=800;
          g.gain.value=0.0001;
          g.gain.exponentialRampToValueAtTime(0.1, ctx.currentTime + 0.01);
          setTimeout(()=> { g.gain.exponentialRampToValueAtTime(0.0001, ctx.currentTime + 0.2); o.stop(ctx.currentTime + 0.21); }, 200);
          o.start();
        }catch(e){}
      }

      // ---- Logs: store workouts ----
      function getLogs(){ try{ return JSON.parse(localStorage.getItem(STORAGE_LOGS) || '[]'); }catch(e){return [];} }
      function saveLog(entry){
        const arr = getLogs();
        arr.unshift(entry);
        localStorage.setItem(STORAGE_LOGS, JSON.stringify(arr));
        renderLogs();
      }
      function renderLogs(){
        const arr = getLogs();
        logsList.innerHTML = '';
        arr.slice(0,30).forEach(l => {
          const el = document.createElement('div'); el.className='log-item';
          el.innerHTML = `<div><strong>${l.name}</strong><div class="small">${new Date(l.date).toLocaleString()}</div></div><div class="small">${l.exercises.length} exercises • ${l.duration || '—'} min</div>`;
          logsList.appendChild(el);
        });
      }
      renderLogs();

      logFromRoutineBtn.addEventListener('click', ()=> {
        if(currentRoutine.length===0) return alert('No exercises in routine');
        const name = routineNameInput.value || 'Routine log';
        const entry = { name, date: Date.now(), exercises: currentRoutine.slice(), duration: Math.round(currentRoutine.length*5) }; // approximate 5min per
        saveLog(entry); alert('Logged: ' + name);
      });
      manualLogBtn.addEventListener('click', ()=> {
        const name = prompt('Workout name');
        if(!name) return;
        const duration = prompt('Duration (minutes)', '30');
        const entry = { name, date: Date.now(), exercises: [], duration: parseInt(duration) || 0 };
        saveLog(entry); alert('Manual log saved');
      });

      // ---- Utilities: modal open on exercise click added earlier ----

      // ---- Persist favorites / routines dropdown ----
      updateRoutinesDropdown();

      // ---- Initial small helpers ----
      function initFavoritesIndicator(){}
      // done

      // Accessibility: Enter in search triggers search
      searchInput.addEventListener('keydown', (e)=> { if(e.key==='Enter') renderList(); });

      // Save routines to preserve across session: done on save button
      // Load sample favorite routine if none present
      if(!localStorage.getItem(STORAGE_ROUTINES)){
        localStorage.setItem(STORAGE_ROUTINES, JSON.stringify([{name:'Full body starter', exercises: ['sq_bwt','push_bwt','row_db','plank'], created: Date.now()}]));
        updateRoutinesDropdown();
      }

      // Render list initially (already called)
      renderList();

      // small keyboard shortcuts for convenience
      document.addEventListener('keydown', (e)=> {
        if(e.key === 'g' && e.ctrlKey){ e.preventDefault(); document.getElementById('genBtn').click(); }
      });

      // Expose some functions to global for quick debugging (optional)
      window._EX = { EXERCISES, renderList, currentRoutine, saveRoutine };

      // End main IIFE
    })();
  </script>
</body>
</html>
